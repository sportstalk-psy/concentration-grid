<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>ST | –¢–∞–±–ª–∏—Ü–∞ –®—É–ª—å—Ç–µ</title>
  <style>
    :root { --gap: 6px; --cell: 44px; --border: #1f2937; --bg: #fff; --muted:#6b7280; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; background:#f5f6f8; }
    header { padding:14px 16px; background:#11161c; color:#fff; font-weight:700; letter-spacing:.02em; }
    main { max-width: 520px; margin: 0 auto; padding: 16px; }
    .card { background: var(--bg); border-radius: 14px; padding: 14px; box-shadow: 0 6px 18px rgba(0,0,0,.06); }
    .row { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    .grow { flex:1; }
    button { cursor:pointer; border:0; border-radius:10px; padding:12px 14px; font-weight:700; }
    .btn-start { background:#cefa07; color:#11161c; }
    .btn-cancel { background:#11161c; color:#cefa07; width:100%; margin-top:12px; }
    .btn-again { background:#cefa07; color:#11161c; width:100%; margin-top:12px; }
    .stats { margin-top: 10px; color: var(--muted); font-weight:600; display:flex; justify-content:space-between; }
    .grid {
      margin-top: 12px;
      display:grid;
      grid-template-columns: repeat(10, minmax(0, 1fr));
      gap: var(--gap);
      user-select:none;
      -webkit-user-select:none;
      touch-action: manipulation;
    }
    .cell {
      height: var(--cell);
      background:#fff;
      border:2px solid var(--border);
      border-radius: 10px;
      display:flex; align-items:center; justify-content:center;
      font-weight:800;
      color:#111827;
      font-variant-numeric: tabular-nums;
    }
    .cell { padding: 0; box-sizing: border-box; }
    .cell:disabled { opacity:.35; }
    .cell.good { background:#e5e7eb; }
    .cell.bad { background:#f96262; border-color:#bc2b2b; }
    .top { margin-bottom:12px; }
    .title { font-size: 28px; font-weight: 800; margin: 0 0 10px; }
    .help { color:#374151; line-height:1.4; margin:0 0 10px; }
    .hidden { display:none !important; }
    .result { font-size: 20px; font-weight: 800; margin: 0 0 6px; }
    .history { margin-top: 10px; color:#374151; font-size:14px; }
    .history ul { margin:8px 0 0; padding-left: 18px; }
  </style>
</head>
<body>
  <header>Sports Talk | –¢–∞–±–ª–∏—Ü–∞ –®—É–ª—å—Ç–µ</header>
  <main>
    <div class="card top" id="intro">
      <p class="title">ST | –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏</p>
      <p class="help">
        –ù–∞–∂–∏–º–∞–π —á–∏—Å–ª–∞ –ø–æ –ø–æ—Ä—è–¥–∫—É –æ—Ç <b>00</b> –¥–æ <b>99</b>. –í—Ä–µ–º—è –∑–∞–ø–∏—à–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
      </p>
      <div class="row">
        <button class="btn-start" id="startBtn">–ù–ê–ß–ê–¢–¨</button>
        <div class="grow"></div>
      </div>
      <div class="history" id="historyBox"></div>
      <div class="history" id="leaderboardIntro"></div>
    </div>

    <div class="card hidden" id="game">
      <div class="stats">
        <div>–í—Ä–µ–º—è: <span id="time">0.0</span></div>
        <div>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: <span id="current">00</span></div>
      </div>
      <div class="grid" id="grid"></div>
      <button class="btn-cancel" id="cancelBtn">–í–´–ô–¢–ò</button>
    </div>

    <div class="card hidden" id="done">
      <p class="result">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</p>
      <p class="help">–í—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏ —Å–µ—Å—Å–∏—é –∑–∞: <b id="finalTime">0:00</b></p>
      <button class="btn-again" id="againBtn">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</button>
      <div id="rankBox" style="margin-top:12px;"></div>
      <div id="leaderboard" class="history"></div>
    </div>
  </main>

  <script>
    const startBtn = document.getElementById('startBtn');
    const cancelBtn = document.getElementById('cancelBtn');
    const againBtn  = document.getElementById('againBtn');

    const intro = document.getElementById('intro');
    const game  = document.getElementById('game');
    const done  = document.getElementById('done');

    const gridEl = document.getElementById('grid');
    const timeEl = document.getElementById('time');
    const curEl  = document.getElementById('current');
    const finalTimeEl = document.getElementById('finalTime');
    const historyBox = document.getElementById('historyBox');

    let expected = 0;
    let startTs = null;
    let rafId = null;
    let running = false;

    function pad2(n){ return String(n).padStart(2,'0'); }

    function getAnonId() {
      const key = "cg_anon_id";
      let id = localStorage.getItem(key);
      if (!id) {
        id = (crypto?.randomUUID ? crypto.randomUUID() : ("id_" + Math.random().toString(16).slice(2) + Date.now()));
        localStorage.setItem(key, id);
      }
      return id;
    }

    function shuffle(a){
      for(let i=a.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i],a[j]] = [a[j],a[i]];
      }
      return a;
    }

    function formatMs(ms){
      const totalSec = Math.floor(ms/1000);
      const m = Math.floor(totalSec/60);
      const s = totalSec%60;
      return `${m}:${String(s).padStart(2,'0')}`;
    }

    function tick(){
      if(!running) return;
      const ms = performance.now() - startTs;
      timeEl.textContent = (ms/1000).toFixed(1);
      rafId = requestAnimationFrame(tick);
    }

    function stopTimer(){
      running = false;
      if(rafId) cancelAnimationFrame(rafId);
      rafId = null;
    }

    function buildGrid(){
      gridEl.innerHTML = '';
      const nums = shuffle(Array.from({length:100}, (_,i)=>i));
      nums.forEach(n=>{
        const btn = document.createElement('button');
        btn.className = 'cell';
        btn.type = 'button';
        btn.textContent = pad2(n);
        btn.dataset.value = String(n);

        btn.addEventListener('click', () => {
          if (!running) return;

          const v = Number(btn.dataset.value);

          // ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∞–ø ‚Äî –ø–æ–¥—Å–≤–µ—Ç–∏—Ç—å –∫—Ä–∞—Å–Ω—ã–º –Ω–∞ –º–≥–Ω–æ–≤–µ–Ω–∏–µ
          if (v !== expected) {
            btn.classList.add('bad');

             // üì≥ –≤–∏–±—Ä–∞—Ü–∏—è (–¢–û–õ–¨–ö–û –µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
               if (window.navigator && window.navigator.vibrate) {
                 navigator.vibrate(30);
               }
            
            setTimeout(() => btn.classList.remove('bad'), 180);
            return;
          }

          // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∞–ø ‚Äî —Å–¥–µ–ª–∞—Ç—å —Å–µ—Ä—ã–º –∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
          btn.classList.add('good');
          btn.disabled = true;

          expected++;
          curEl.textContent = pad2(expected);

          if (expected === 100) {
            const ms = performance.now() - startTs;
            finish(ms);
          }
        });

        gridEl.appendChild(btn);
      });
    }

    function showHistory(){
      const key = 'cg_history';
      const list = JSON.parse(localStorage.getItem(key) || '[]');
      if(list.length === 0){
        historyBox.innerHTML = '<b>–ò—Å—Ç–æ—Ä–∏—è:</b> –ø–æ–∫–∞ –ø—É—Å—Ç–æ';
        return;
      }
      const items = list.slice(-5).reverse().map(x=>`<li>${x.time} ‚Äî ${new Date(x.at).toLocaleString()}</li>`).join('');
      historyBox.innerHTML = `<b>–ò—Å—Ç–æ—Ä–∏—è (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 5):</b><ul>${items}</ul>`;
    }

    function saveHistory(ms){
      const key = 'cg_history';
      const list = JSON.parse(localStorage.getItem(key) || '[]');
      list.push({ ms, time: formatMs(ms), at: Date.now() });
      localStorage.setItem(key, JSON.stringify(list));
    }

    function normalizePhone(raw) {
      const s = String(raw || "").trim();
      if (!s) return "";
      // –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã
      let d = s.replace(/\D+/g, "");
      // –†–§: 8XXXXXXXXXX -> 7XXXXXXXXXX
      if (d.length === 11 && d.startsWith("8")) d = "7" + d.slice(1);
      // –†–§: 9XXXXXXXXX -> 7XXXXXXXXXX
      if (d.length === 10 && d.startsWith("9")) d = "7" + d;
      // –µ—Å–ª–∏ –ø–æ–ª—É—á–∏–ª–æ—Å—å 11 —Ü–∏—Ñ—Ä –∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 7 ‚Äî –æ–∫
      if (d.length === 11 && d.startsWith("7")) return d;
      // –∏–Ω–∞—á–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–∞–∫ –µ—Å—Ç—å (–Ω–∞ –±—É–¥—É—â–µ–µ: –¥—Ä—É–≥–∏–µ —Å—Ç—Ä–∞–Ω—ã)
      return d;
    }
    
    function sendResult(ms, eventName){
      const consent = localStorage.getItem("cg_consent") === "1";
      const phone = consent ? (localStorage.getItem("cg_phone") || "") : "";
      const nickname = consent ? (localStorage.getItem("cg_nickname") || "") : "";
    
      const payload = new URLSearchParams({
        time_ms: String(ms),
        time: formatMs(ms),
        event: eventName,
        anon_id: getAnonId(),
        user_key: (localStorage.getItem("cg_consent")==="1" && (localStorage.getItem("cg_phone")||"").trim())
          ? (localStorage.getItem("cg_phone")||"").trim()
          : getAnonId(),
        phone,
        nickname,
        page: location.href,
        utm: new URLSearchParams(location.search).toString(),
        ua: navigator.userAgent
      }).toString();
    
      const url = "https://script.google.com/macros/s/AKfycbxcIpdFg1nqxps6YplBC8z4tL3loNXZbBntEx2RNmCTp4SBhdMVeBvojcS5gVgMZWHY/exec";
    
      if (navigator.sendBeacon) {
        navigator.sendBeacon(url, new Blob([payload], { type: "application/x-www-form-urlencoded;charset=UTF-8" }));
      } else {
        fetch(url, { method: "POST", mode: "no-cors", headers: { "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8" }, body: payload });
      }
    }    

    function start(){
      expected = 0;
      curEl.textContent = '00';
      timeEl.textContent = '0.0';
      buildGrid();

      intro.classList.add('hidden');
      done.classList.add('hidden');
      game.classList.remove('hidden');

      // iOS/Safari: —Å—Ç–∞—Ä—Ç –ø–æ—Å–ª–µ —è–≤–Ω–æ–≥–æ –∫–ª–∏–∫–∞, —á—Ç–æ–±—ã –≤—Å—ë –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
      startTs = performance.now();
      running = true;
      tick();
    }

    function cancel(){
      stopTimer();
      intro.classList.remove('hidden');
      game.classList.add('hidden');
      done.classList.add('hidden');
      showHistory();
    }

    function finish(ms){
      stopTimer();
      saveHistory(ms);
      renderRankBox(ms);
      finalTimeEl.textContent = formatMs(ms);
      
      sendResult(ms, "finish_anonymous");
    
      game.classList.add('hidden');
      done.classList.remove('hidden');
      showHistory();
      loadLeaderboard();
    }

function getProfile(){
  return {
    nickname: localStorage.getItem("cg_nickname") || "",
    phone: localStorage.getItem("cg_phone") || "",
    consent: localStorage.getItem("cg_consent") === "1"
  };
}

function setProfile({nickname, phone, consent}){
  if (nickname) localStorage.setItem("cg_nickname", nickname);
  if (phone !== undefined) localStorage.setItem("cg_phone", normalizePhone(phoneInputValue));
  localStorage.setItem("cg_consent", consent ? "1" : "0");
}

const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbxcIpdFg1nqxps6YplBC8z4tL3loNXZbBntEx2RNmCTp4SBhdMVeBvojcS5gVgMZWHY/exec";

function loadLeaderboard() {
  const targets = [
    document.getElementById("leaderboard"),
    document.getElementById("leaderboardIntro")
  ].filter(Boolean);
  
  if (targets.length === 0) return;
  
  targets.forEach(el => el.innerHTML = "<b>–†–µ–π—Ç–∏–Ω–≥:</b> –∑–∞–≥—Ä—É–∂–∞–µ–º‚Ä¶");

  const cbName = "lb_cb_" + Date.now() + "_" + Math.random().toString(16).slice(2);
  const script = document.createElement("script");

  window[cbName] = (data) => {
    try {
      const top = Array.isArray(data?.top) ? data.top : [];
      if (top.length === 0) {
        targets.forEach(t => t.innerHTML = "<b>–†–µ–π—Ç–∏–Ω–≥:</b> –ø–æ–∫–∞ –ø—É—Å—Ç–æ");
        return;
      }
  const myPhone = normalizePhone(localStorage.getItem("cg_phone") || "");
  const myKey =
    (localStorage.getItem("cg_consent") === "1" && myPhone)
      ? myPhone
      : (localStorage.getItem("cg_anon_id") || "");
  
  const items = top.map(x => {
    const seconds = (x.time_ms / 1000).toFixed(1);
    const date = x.timestamp
      ? new Date(x.timestamp).toLocaleDateString("ru-RU")
      : "";
  
    const isMe = x.key && myKey && String(x.key) === String(myKey);
  
    return `
      <li style="${isMe ? "background:#eef2ff;border-radius:10px;padding:6px 8px;" : ""}">
        <b>#${x.rank}</b>
        ${escapeHtml(x.nickname)}${isMe ? ' <b>(–≤—ã)</b>' : ''}
        <span style="color:#6b7280;"> ¬∑ ${date} ¬∑ ${seconds} c</span>
      </li>
    `;
  }).join("");
  
  targets.forEach(t => {
    t.innerHTML = `<b>–†–µ–π—Ç–∏–Ω–≥ (—Ç–æ–ø-20):</b><ul>${items}</ul>`;
  });
    } finally {
      cleanup();
    }
  };

  script.onerror = () => {
    targets.forEach(t => t.innerHTML = "<b>–†–µ–π—Ç–∏–Ω–≥:</b> –Ω–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å");
    cleanup();
  };  

  function cleanup() {
    delete window[cbName];
    script.remove();
  }

  script.onerror = () => {
    targets.forEach(t => t.innerHTML = "<b>–†–µ–π—Ç–∏–Ω–≥:</b> –Ω–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å");
    cleanup();
  };

  script.src = `${WEBAPP_URL}?action=leaderboard&limit=20&callback=${encodeURIComponent(cbName)}&_=${Date.now()}`;
  document.body.appendChild(script);
}
    
function renderRankBox(lastMs){
  const box = document.getElementById("rankBox");
  if (!box) return;

  const p = getProfile();

  // –µ—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å –Ω–∏–∫ –∏ —Å–æ–≥–ª–∞—Å–∏–µ ‚Äî –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º ‚Äú–≤—ã –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ‚Äù
  if (p.nickname && p.consent) {
    box.innerHTML = `
      <div class="history">
        <b>–†–µ–π—Ç–∏–Ω–≥:</b> –≤—ã —É—á–∞—Å—Ç–≤—É–µ—Ç–µ –∫–∞–∫ <b>${escapeHtml(p.nickname)}</b>
        <div style="margin-top:8px;">
          <button class="btn-again" id="editProfileBtn" type="button">–ò–∑–º–µ–Ω–∏—Ç—å –Ω–∏–∫ / —Ç–µ–ª–µ—Ñ–æ–Ω / —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–æ–≤—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å</button>
        </div>
      </div>
    `;
    document.getElementById("editProfileBtn").addEventListener("click", () => {
      box.innerHTML = profileFormHtml(p.nickname, p.phone, p.consent, true);
      bindProfileForm(lastMs);
    });
    return;
  }

  // –∏–Ω–∞—á–µ ‚Äî –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –∑–∞–ø–∏—Å–∞—Ç—å
  box.innerHTML = `
    <div class="history">
      <b>–ó–∞–ø–∏—Å–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Ä–µ–π—Ç–∏–Ω–≥?</b>
      <div style="margin-top:8px;">
        <button class="btn-again" id="saveToRankBtn" type="button">–î–∞, –∑–∞–ø–∏—Å–∞—Ç—å</button>
      </div>
      <div style="margin-top:6px; color:#6b7280; font-size:13px;">
        –£–∫–∞–∂–∏—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω, –µ—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —Ç–µ—Å—Ç —Å —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –∏ –ù–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤–∏–¥–µ–Ω –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ.
      </div>
    </div>
  `;

  document.getElementById("saveToRankBtn").addEventListener("click", () => {
    box.innerHTML = profileFormHtml(p.nickname, p.phone, p.consent, false);
    bindProfileForm(lastMs);
  });
}

function profileFormHtml(nickname, phone, consent, isEdit){
  return `
    <div class="history">
      <b>${isEdit ? "–ü—Ä–æ—Ñ–∏–ª—å –¥–ª—è —Ä–µ–π—Ç–∏–Ω–≥–∞" : "–ü—Ä–æ—Ñ–∏–ª—å –¥–ª—è —Ä–µ–π—Ç–∏–Ω–≥–∞"}</b>
      <div style="margin-top:10px; display:flex; flex-direction:column; gap:8px;">
        <input id="nickInput" placeholder="Nickname (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" value="${escapeAttr(nickname)}"
               style="padding:12px 14px; border-radius:10px; border:1px solid #d1d5db; font-weight:700;"/>
        <input id="phoneInput" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) 79998887766" value="${escapeAttr(phone)}"
               inputmode="tel"
               style="padding:12px 14px; border-radius:10px; border:1px solid #d1d5db; font-weight:700;"/>

        <label style="display:flex; gap:10px; align-items:flex-start; font-size:13px; color:#374151; line-height:1.35;">
          <input id="consentInput" type="checkbox" ${consent ? "checked" : ""} style="margin-top:3px;"/>
          <span>–Ø —Å–æ–≥–ª–∞—Å–µ–Ω(–Ω–∞) –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—é –º–æ–µ–≥–æ nickname –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ.</span>
        </label>

        <button class="btn-again" id="saveProfileBtn" type="button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>
      <div id="profileErr" style="margin-top:8px; color:#b91c1c; font-weight:700;"></div>
    </div>
  `;
}

    function bindProfileForm(lastMs){
      const err = document.getElementById("profileErr");
      const nickEl = document.getElementById("nickInput");
      const phoneEl = document.getElementById("phoneInput");
      const consentEl = document.getElementById("consentInput");
      const saveBtn = document.getElementById("saveProfileBtn");
    
      saveBtn.addEventListener("click", () => {
        const nickname = (nickEl.value || "").trim();
        const phoneRaw = (phoneEl.value || "").trim();
        const consent = !!consentEl.checked;
    
        if (!nickname) {
          err.textContent = "–í–≤–µ–¥–∏—Ç–µ nickname.";
          return;
        }
        if (!consent) {
          err.textContent = "–ù—É–∂–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —Å–æ–≥–ª–∞—Å–∏–µ.";
          return;
        }
        // —Ç–µ–ª–µ—Ñ–æ–Ω –æ–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω, –Ω–æ –µ—Å–ª–∏ –≤–≤–µ–ª–∏ ‚Äî —á–∏—Å—Ç–∏–º –¥–æ —Ü–∏—Ñ—Ä
        const phone = phoneRaw ? phoneRaw.replace(/\D/g, "") : "";
    
        setProfile({ nickname, phone, consent });
        sendResult(lastMs, "finish_ranked");
        setTimeout(loadLeaderboard, 800);
        err.textContent = "";
    
        // –ø–µ—Ä–µ—Ä–∏—Å—É–µ–º –±–ª–æ–∫ –∏ (–≤–∞–∂–Ω–æ) –æ—Ç–ø—Ä–∞–≤–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É–∂–µ —Å –Ω–∏–∫–æ–º/—Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
        // –æ—Ç–ø—Ä–∞–≤–∫–∞ –∏–¥—ë—Ç —á–µ—Ä–µ–∑ finish(ms) –≤ Google ‚Äî —Ç—ã —É–∂–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—à—å phone; –¥–æ–±–∞–≤–∏–º nickname –≤ payload –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ
        renderRankBox(lastMs);
      });
    }
    
    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
    }
    function escapeAttr(s){
      return escapeHtml(s).replace(/"/g, "&quot;");
    }
    
    startBtn.addEventListener('click', start);
    cancelBtn.addEventListener('click', cancel);
    againBtn.addEventListener('click', start);

    showHistory();
    loadLeaderboard();
  </script>
</body>
</html>
